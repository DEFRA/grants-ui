# To set up Sonar cloud follow https://github.com/DEFRA/cdp-documentation/blob/main/howto/sonarcloud.md
# Update properties in this file as per the howto instructions
# Uncomment properties in this .github/workflows/check-pull-request.yml
# Uncomment properties in this .github/workflows/publish.yml
# Uncomment properties in this .github/workflows/publish-hotfix.yml

sonar.projectKey=DEFRA_grants-ui
sonar.organization=defra

sonar.links.homepage=https://github.com/DEFRA/grants-ui
sonar.links.ci=https://github.com/DEFRA/grants-ui/actions
sonar.links.scm=https://github.com/DEFRA/grants-ui
sonar.links.issue=https://github.com/DEFRA/grants-ui/issues

sonar.sources=src/
# Exclude test files and configuration files with legitimate repetitive structures
sonar.exclusions=src/**/*.test.js,**/__mocks__/**
sonar.tests=src/
sonar.test.inclusions=src/**/*.test.js

sonar.javascript.lcov.reportPaths=./coverage/lcov.info

# JavaScript test framework configuration for Vitest
# Configure Sonar to properly recognize Vitest assertion patterns
sonar.javascript.globals=vi,test,it,describe,expect,beforeEach,afterEach,beforeAll,afterAll

# Address S2699 false positives for specific files with known Vitest async assertion issues
# This is more targeted than a blanket exclusion but avoids modifying every test file
sonar.issue.ignore.multicriteria=e1,e2,e3,e4,e5,e6,e7,e8,e9,e10,e11,e13
sonar.issue.ignore.multicriteria.e1.ruleKey=javascript:S2699
sonar.issue.ignore.multicriteria.e1.resourceKey=**/validate-backend-auth.test.js
sonar.issue.ignore.multicriteria.e2.ruleKey=javascript:S2699
sonar.issue.ignore.multicriteria.e2.resourceKey=**/get-sign-out-url.test.js
sonar.issue.ignore.multicriteria.e3.ruleKey=javascript:S2699
sonar.issue.ignore.multicriteria.e3.resourceKey=**/refresh-tokens.test.js
sonar.issue.ignore.multicriteria.e4.ruleKey=javascript:S2699
sonar.issue.ignore.multicriteria.e4.resourceKey=**/verify-token.test.js
sonar.issue.ignore.multicriteria.e5.ruleKey=javascript:S2699
sonar.issue.ignore.multicriteria.e5.resourceKey=**/persist-state-helper.test.js
sonar.issue.ignore.multicriteria.e6.ruleKey=javascript:S2699
sonar.issue.ignore.multicriteria.e6.resourceKey=**/check-answers-page.controller.test.js
sonar.issue.ignore.multicriteria.e7.ruleKey=javascript:S2699
sonar.issue.ignore.multicriteria.e7.resourceKey=**/submission-page.controller.test.js
sonar.issue.ignore.multicriteria.e8.ruleKey=javascript:S2699
sonar.issue.ignore.multicriteria.e8.resourceKey=**/land-grants.service.test.js
sonar.issue.ignore.multicriteria.e9.ruleKey=javascript:S2699
sonar.issue.ignore.multicriteria.e9.resourceKey=**/sbi.controller.test.js
sonar.issue.ignore.multicriteria.e10.ruleKey=javascript:S2699
sonar.issue.ignore.multicriteria.e10.resourceKey=**/config-loader.test.js
sonar.issue.ignore.multicriteria.e11.ruleKey=javascript:S2699
sonar.issue.ignore.multicriteria.e11.resourceKey=**/consolidated-view.service.test.js
sonar.issue.ignore.multicriteria.e12.ruleKey=javascript:S*
sonar.issue.ignore.multicriteria.e12.resourceKey=**/plugins/tasklist-back-button.js
sonar.issue.ignore.multicriteria.e13.ruleKey=javascript:S6elements
sonar.issue.ignore.multicriteria.e13.resourceKey=**/form-slug-helper.js

# Exclude files from Copy/Paste Detection (duplication checks)
# - Test files are excluded as they often have similar patterns
# - Configuration and model definition files are excluded as they legitimately contain repetitive data structures
sonar.cpd.exclusions=src/**/*.test.js
sonar.coverage.exclusions=**/logger-options.js,**/config.js,**/config/land-grants.js,**/index.js,**/__mocks__/**,**/test-helpers/**,**/test-helpers.js,**/plugins/tasklist-back-button.js,**/test-constants.js
