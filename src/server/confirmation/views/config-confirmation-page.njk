{% extends "layouts/page.njk" %}
{% set backLink = false %}
{% from "govuk/components/panel/macro.njk" import govukPanel %}
{% from "dev-mode-banner/macro.njk" import appDevModeBanner %}
{% from "support-details/macro.njk" import defraSupportDetails %}
{% from "two-thirds-column/macro.njk" import appTwoThirdsColumn %}

{% set mainClasses = "govuk-main-wrapper--l" %}

{% block content %}
  {% call appTwoThirdsColumn() %}
    {{ appDevModeBanner({
        isDevelopmentMode: isDevelopmentMode,
        formSlug: formSlug,
        formTitle: formTitle,
        demoRoute: "/dev/demo-confirmation/" + formSlug if formSlug else null,
        routePattern: "/dev/demo-confirmation/{slug}",
        dataSource: 'Session data' if usingSessionData else 'Demo data'
      }) }}

      {# FIXED SECTION: Always displayed - Application complete message and reference number #}
      {{ govukPanel({
        titleText: confirmationContent.panelTitle or "Application complete",
        html: ((confirmationContent.panelText or "Your application number") + "<br><strong>" + referenceNumber + "</strong>") | safe
      }) }}

      {# CONFIGURABLE SECTION: HTML content from YAML or default content #}
      {% if confirmationContent and confirmationContent.html %}
        {# Direct HTML injection from YAML #}
        {{ confirmationContent.html | safe }}
      {% else %}
        {# Default content from image if no configuration provided #}
        <p class="govuk-body">It may be useful to write down your application number, so you have it ready if you need to contact us.</p>

        <h2 class="govuk-heading-m">What happens next</h2>
        <p class="govuk-body">Defra will email you when your funding offer is available to review. This will be within 5 working days.</p>
        <p class="govuk-body">You will need to sign in to the service to accept your funding offer.</p>
        <p class="govuk-body">You should not start work on the actions you have applied for until:</p>
        <ul class="govuk-list govuk-list--bullet govuk-!-margin-bottom-6">
          <li>you have accepted your offer</li>
          <li>the Rural Payments Agency confirms your start date</li>
        </ul>

        {{ defraSupportDetails({ typeOfSupport: 'question' }) }}
      {% endif %}
  {% endcall %}
{% endblock %}
